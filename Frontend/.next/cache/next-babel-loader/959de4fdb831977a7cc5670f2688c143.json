{"ast":null,"code":"var _jsxFileName = \"/Users/jinho/Project/ProjectFrontend/components/common/Header.jsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport Link from \"next/link\";\nimport { Layout, Menu, Button, Badge } from \"antd\";\nimport { BellOutlined } from \"@ant-design/icons\";\nimport styled, { css } from \"styled-components\";\nimport { withRouter } from \"next/router\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { logoutRequestAction } from \"../../reducers/user\";\nimport firebase from \"../../firebase\";\n/**\n * @author 박진호\n * @version 1.0\n * @summary 헤더 컴포넌트(함수형)\n */\n// style\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AntHeader = Layout.Header;\nconst HeaderWrapper = styled(AntHeader).withConfig({\n  displayName: \"Header__HeaderWrapper\",\n  componentId: \"sc-1jkvt1g-0\"\n})([\"position:fixed;z-index:10;width:100%;background:#16172b;\"]);\nconst InnerHeader = styled.div.withConfig({\n  displayName: \"Header__InnerHeader\",\n  componentId: \"sc-1jkvt1g-1\"\n})([\"width:1300px;margin:0 auto;display:flex;.ant-menu-horizontal{border:none;}@media (max-width:1368px){width:100%;}@media (max-width:1368px){justify-content:space-between;}\"]);\nconst LogoWrapper = styled.div.withConfig({\n  displayName: \"Header__LogoWrapper\",\n  componentId: \"sc-1jkvt1g-2\"\n})([\"float:left;cursor:pointer;color:#fff;text-align:center;font-weight:bold;font-size:20px;width:100px;\"]);\nconst MenuWrapper = styled.div.withConfig({\n  displayName: \"Header__MenuWrapper\",\n  componentId: \"sc-1jkvt1g-3\"\n})([\"background:#16172b;font-size:18px;margin:0 auto;height:64px;display:flex;@media (max-width:950px){display:none;}\"]);\nconst MenuItemWrapper = styled.div.withConfig({\n  displayName: \"Header__MenuItemWrapper\",\n  componentId: \"sc-1jkvt1g-4\"\n})([\"padding:0 30px;a{color:#fff;font-weight:500;\", \"}\"], props => {\n  if (props.currentMenu) {\n    return css([\"color:#1890ff;\"]);\n  }\n});\nconst ButtonGroup = styled.div.withConfig({\n  displayName: \"Header__ButtonGroup\",\n  componentId: \"sc-1jkvt1g-5\"\n})([\".btn-register{margin-left:10px;background:#313355;border:1px solid #313355;&:hover{border:1px solid #16172b;}}.btn-logout{margin-left:10px;background:#313355;border:1px solid #313355;&:hover{border:1px solid #16172b;}}.btn-login{&:hover{color:#313355;border:1px solid #313355;}}.btn-mypage{&:hover{color:#313355;border:1px solid #313355;}}@media (max-width:768px){.btn-mypage,.btn-logout{width:70px;font-size:12px;padding:0;}}\"]);\nconst BadgeWrapper = styled.div.withConfig({\n  displayName: \"Header__BadgeWrapper\",\n  componentId: \"sc-1jkvt1g-6\"\n})([\"margin-right:60px;\"]);\nconst MobileMenuWrapper = styled.div.withConfig({\n  displayName: \"Header__MobileMenuWrapper\",\n  componentId: \"sc-1jkvt1g-7\"\n})([\"position:fixed;top:64px;left:0;right:0;width:100%;margin:0;background:#16172bcc;z-index:10;display:flex;justify-content:center;\", \" @media (min-width:950px){display:none;}\"], props => {\n  if (props.currentMenu) {\n    return css([\"color:#1890ff;\"]);\n  }\n});\n\nconst Header = ({\n  router\n}) => {\n  // redux\n  const dispatch = useDispatch();\n  const {\n    me,\n    logoutLoading\n  } = useSelector(state => state.user); // local state\n\n  const {\n    0: currentMenu,\n    1: setCurrentMenu\n  } = useState(null);\n  const {\n    0: globalCount,\n    1: setGlobalCount\n  } = useState(0);\n  const {\n    0: chatRoomsRef,\n    1: setChatRoomsRef\n  } = useState(firebase.database().ref(\"chatRooms\")); // event listener\n\n  const onLogout = useCallback(async () => {\n    let user = firebase.auth().currentUser;\n\n    if (user) {\n      await firebase.auth().signOut().then(() => {});\n      let firebaseMe = null;\n      await firebase.database().ref(\"users\").child(user.uid).once(\"value\", function (data) {\n        firebaseMe = data.val();\n      });\n      await firebase.database().ref(\"users\").child(user.uid).update(_objectSpread(_objectSpread({}, firebaseMe), {}, {\n        isInMypage: false\n      }));\n    }\n\n    dispatch(logoutRequestAction());\n  }, []);\n  useEffect(async () => {\n    setTimeout(() => {\n      let globalCount = 0;\n      let tmpChatRoomInfo = [];\n      me && chatRoomsRef.on(\"child_changed\", DataSnapshot => {\n        if (DataSnapshot.val()[me.nickname]) {\n          globalCount++;\n          setGlobalCount(globalCount);\n        } else {\n          tmpChatRoomInfo.forEach((v, i) => {\n            if (v.chatRoomId === DataSnapshot.val().id) {\n              globalCount -= v.count;\n            }\n          });\n          setGlobalCount(globalCount);\n        }\n      });\n      me && chatRoomsRef.on(\"child_added\", DataSnapshot => {\n        if (DataSnapshot.val()[me.nickname]) {\n          globalCount += DataSnapshot.val()[me.nickname].count;\n          tmpChatRoomInfo.push(DataSnapshot.val()[me.nickname]);\n          setGlobalCount(globalCount);\n        }\n      });\n      me && chatRoomsRef.on(\"child_removed\", DataSnapshot => {// deprecated.\n      });\n    }, 700);\n  }, []); // hooks\n\n  useEffect(() => {\n    const route = router.route.split(\"/\");\n    setCurrentMenu(`${route[2]}`);\n  }, [router]);\n  useEffect(() => {\n    return () => chatRoomsRef.off();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(HeaderWrapper, {\n    children: [/*#__PURE__*/_jsxDEV(InnerHeader, {\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        href: \"/\",\n        children: /*#__PURE__*/_jsxDEV(\"a\", {\n          children: /*#__PURE__*/_jsxDEV(LogoWrapper, {\n            children: \"CodePlat\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MenuWrapper, {\n        children: [/*#__PURE__*/_jsxDEV(MenuItemWrapper, {\n          className: \"menu-study\",\n          currentMenu: currentMenu === \"study\" ? true : false,\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            href: \"/articles/study\",\n            children: /*#__PURE__*/_jsxDEV(\"a\", {\n              children: \"\\uC2A4\\uD130\\uB514\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 13\n          }, this)\n        }, \"/articles/study\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(MenuItemWrapper, {\n          className: \"menu-project\",\n          currentMenu: currentMenu === \"project\" ? true : false,\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            href: \"/articles/project\",\n            children: /*#__PURE__*/_jsxDEV(\"a\", {\n              children: \"\\uD504\\uB85C\\uC81D\\uD2B8\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 13\n          }, this)\n        }, \"/articles/project\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(MenuItemWrapper, {\n          className: \"menu-forum\",\n          currentMenu: currentMenu === \"forum\" ? true : false,\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            href: \"/articles/forum\",\n            children: /*#__PURE__*/_jsxDEV(\"a\", {\n              children: \"\\uD3EC\\uB7FC\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 268,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 13\n          }, this)\n        }, \"/articles/forum\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 9\n      }, this), me && /*#__PURE__*/_jsxDEV(BadgeWrapper, {\n        children: /*#__PURE__*/_jsxDEV(Badge, {\n          count: globalCount,\n          offset: [20, 0],\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            href: \"/mypage\",\n            children: /*#__PURE__*/_jsxDEV(\"a\", {\n              className: \"head-example\",\n              children: /*#__PURE__*/_jsxDEV(BellOutlined, {\n                style: {\n                  color: \"#fff\"\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 277,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 11\n      }, this), !me ? /*#__PURE__*/_jsxDEV(ButtonGroup, {\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          href: \"/auth/login\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn-login\",\n              children: \"\\uB85C\\uADF8\\uC778\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          href: \"/auth/register\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn-register\",\n              type: \"primary\",\n              children: \"\\uD68C\\uC6D0\\uAC00\\uC785\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(ButtonGroup, {\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          href: \"/mypage\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn-mypage\",\n              children: \"\\uB9C8\\uC774\\uD398\\uC774\\uC9C0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 303,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          className: \"btn-logout\",\n          type: \"primary\",\n          onClick: onLogout,\n          loading: logoutLoading,\n          children: \"\\uB85C\\uADF8\\uC544\\uC6C3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MobileMenuWrapper, {\n      children: [/*#__PURE__*/_jsxDEV(MenuItemWrapper, {\n        className: \"menu-study\",\n        currentMenu: currentMenu === \"study\" ? true : false,\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          href: \"/articles/study\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            children: \"\\uC2A4\\uD130\\uB514\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 11\n        }, this)\n      }, \"/articles/study\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MenuItemWrapper, {\n        className: \"menu-project\",\n        currentMenu: currentMenu === \"project\" ? true : false,\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          href: \"/articles/project\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            children: \"\\uD504\\uB85C\\uC81D\\uD2B8\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 11\n        }, this)\n      }, \"/articles/project\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(MenuItemWrapper, {\n        className: \"menu-forum\",\n        currentMenu: currentMenu === \"forum\" ? true : false,\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          href: \"/articles/forum\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            children: \"\\uD3EC\\uB7FC\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 11\n        }, this)\n      }, \"/articles/forum\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 233,\n    columnNumber: 5\n  }, this);\n};\n\nexport default withRouter(Header);","map":{"version":3,"sources":["/Users/jinho/Project/ProjectFrontend/components/common/Header.jsx"],"names":["React","useState","useEffect","useCallback","Link","Layout","Menu","Button","Badge","BellOutlined","styled","css","withRouter","useSelector","useDispatch","logoutRequestAction","firebase","AntHeader","Header","HeaderWrapper","InnerHeader","div","LogoWrapper","MenuWrapper","MenuItemWrapper","props","currentMenu","ButtonGroup","BadgeWrapper","MobileMenuWrapper","router","dispatch","me","logoutLoading","state","user","setCurrentMenu","globalCount","setGlobalCount","chatRoomsRef","setChatRoomsRef","database","ref","onLogout","auth","currentUser","signOut","then","firebaseMe","child","uid","once","data","val","update","isInMypage","setTimeout","tmpChatRoomInfo","on","DataSnapshot","nickname","forEach","v","i","chatRoomId","id","count","push","route","split","off","color"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport Link from \"next/link\";\nimport { Layout, Menu, Button, Badge } from \"antd\";\nimport { BellOutlined } from \"@ant-design/icons\";\nimport styled, { css } from \"styled-components\";\nimport { withRouter } from \"next/router\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { logoutRequestAction } from \"../../reducers/user\";\nimport firebase from \"../../firebase\";\n\n/**\n * @author 박진호\n * @version 1.0\n * @summary 헤더 컴포넌트(함수형)\n */\n\n// style\n\nconst AntHeader = Layout.Header;\n\nconst HeaderWrapper = styled(AntHeader)`\n  position: fixed;\n  z-index: 10;\n  width: 100%;\n  background: #16172b;\n`;\n\nconst InnerHeader = styled.div`\n  width: 1300px;\n  margin: 0 auto;\n  display: flex;\n  .ant-menu-horizontal {\n    border: none;\n  }\n  @media (max-width: 1368px) {\n    width: 100%;\n  }\n  @media (max-width: 1368px) {\n    justify-content: space-between;\n  }\n`;\n\nconst LogoWrapper = styled.div`\n  float: left;\n  cursor: pointer;\n  color: #fff;\n  text-align: center;\n  font-weight: bold;\n  font-size: 20px;\n  width: 100px;\n`;\n\nconst MenuWrapper = styled.div`\n  background: #16172b;\n  font-size: 18px;\n  margin: 0 auto;\n  height: 64px;\n  display: flex;\n\n  @media (max-width: 950px) {\n    display: none;\n  }\n`;\n\nconst MenuItemWrapper = styled.div`\n  padding: 0 30px;\n\n  a {\n    color: #fff;\n    font-weight: 500;\n    ${(props) => {\n      if (props.currentMenu) {\n        return css`\n          color: #1890ff;\n        `;\n      }\n    }}\n  }\n`;\n\nconst ButtonGroup = styled.div`\n  .btn-register {\n    margin-left: 10px;\n    background: #313355;\n    border: 1px solid #313355;\n    &:hover {\n      border: 1px solid #16172b;\n    }\n  }\n  .btn-logout {\n    margin-left: 10px;\n    background: #313355;\n    border: 1px solid #313355;\n    &:hover {\n      border: 1px solid #16172b;\n    }\n  }\n  .btn-login {\n    &:hover {\n      color: #313355;\n      border: 1px solid #313355;\n    }\n  }\n  .btn-mypage {\n    &:hover {\n      color: #313355;\n      border: 1px solid #313355;\n    }\n  }\n  @media (max-width: 768px) {\n    .btn-mypage,\n    .btn-logout {\n      width: 70px;\n      font-size: 12px;\n      padding: 0;\n    }\n  }\n`;\n\nconst BadgeWrapper = styled.div`\n  margin-right: 60px;\n`;\n\nconst MobileMenuWrapper = styled.div`\n  position: fixed;\n  top: 64px;\n  left: 0;\n  right: 0;\n  width: 100%;\n  margin: 0;\n  background: #16172bcc;\n  z-index: 10;\n  display: flex;\n  justify-content: center;\n  ${(props) => {\n    if (props.currentMenu) {\n      return css`\n        color: #1890ff;\n      `;\n    }\n  }}\n  @media (min-width: 950px) {\n    display: none;\n  }\n`;\n\nconst Header = ({ router }) => {\n  // redux\n\n  const dispatch = useDispatch();\n  const { me, logoutLoading } = useSelector((state) => state.user);\n\n  // local state\n\n  const [currentMenu, setCurrentMenu] = useState(null);\n  const [globalCount, setGlobalCount] = useState(0);\n  const [chatRoomsRef, setChatRoomsRef] = useState(\n    firebase.database().ref(\"chatRooms\"),\n  );\n\n  // event listener\n\n  const onLogout = useCallback(async () => {\n    let user = firebase.auth().currentUser;\n    if (user) {\n      await firebase\n        .auth()\n        .signOut()\n        .then(() => {});\n      let firebaseMe = null;\n      await firebase\n        .database()\n        .ref(\"users\")\n        .child(user.uid)\n        .once(\"value\", function (data) {\n          firebaseMe = data.val();\n        });\n      await firebase\n        .database()\n        .ref(\"users\")\n        .child(user.uid)\n        .update({ ...firebaseMe, isInMypage: false });\n    }\n\n    dispatch(logoutRequestAction());\n  }, []);\n\n  useEffect(async () => {\n    setTimeout(() => {\n      let globalCount = 0;\n      let tmpChatRoomInfo = [];\n      me &&\n        chatRoomsRef.on(\"child_changed\", (DataSnapshot) => {\n          if (DataSnapshot.val()[me.nickname]) {\n            globalCount++;\n            setGlobalCount(globalCount);\n          } else {\n            tmpChatRoomInfo.forEach((v, i) => {\n              if (v.chatRoomId === DataSnapshot.val().id) {\n                globalCount -= v.count;\n              }\n            });\n            setGlobalCount(globalCount);\n          }\n        });\n      me &&\n        chatRoomsRef.on(\"child_added\", (DataSnapshot) => {\n          if (DataSnapshot.val()[me.nickname]) {\n            globalCount += DataSnapshot.val()[me.nickname].count;\n            tmpChatRoomInfo.push(DataSnapshot.val()[me.nickname]);\n            setGlobalCount(globalCount);\n          }\n        });\n      me &&\n        chatRoomsRef.on(\"child_removed\", (DataSnapshot) => {\n          // deprecated.\n        });\n    }, 700);\n  }, []);\n\n  // hooks\n\n  useEffect(() => {\n    const route = router.route.split(\"/\");\n    setCurrentMenu(`${route[2]}`);\n  }, [router]);\n\n  useEffect(() => {\n    return () => chatRoomsRef.off();\n  }, []);\n\n  return (\n    <HeaderWrapper>\n      <InnerHeader>\n        <Link href=\"/\">\n          <a>\n            <LogoWrapper>CodePlat</LogoWrapper>\n          </a>\n        </Link>\n\n        <MenuWrapper>\n          <MenuItemWrapper\n            key=\"/articles/study\"\n            className=\"menu-study\"\n            currentMenu={currentMenu === \"study\" ? true : false}\n          >\n            <Link href=\"/articles/study\">\n              <a>스터디</a>\n            </Link>\n          </MenuItemWrapper>\n\n          <MenuItemWrapper\n            key=\"/articles/project\"\n            className=\"menu-project\"\n            currentMenu={currentMenu === \"project\" ? true : false}\n          >\n            <Link href=\"/articles/project\">\n              <a>프로젝트</a>\n            </Link>\n          </MenuItemWrapper>\n\n          <MenuItemWrapper\n            key=\"/articles/forum\"\n            className=\"menu-forum\"\n            currentMenu={currentMenu === \"forum\" ? true : false}\n          >\n            <Link href=\"/articles/forum\">\n              <a>포럼</a>\n            </Link>\n          </MenuItemWrapper>\n        </MenuWrapper>\n        {me && (\n          <BadgeWrapper>\n            <Badge count={globalCount} offset={[20, 0]}>\n              <Link href=\"/mypage\">\n                <a className=\"head-example\">\n                  <BellOutlined style={{ color: \"#fff\" }} />\n                </a>\n              </Link>\n            </Badge>\n          </BadgeWrapper>\n        )}\n\n        {!me ? (\n          <ButtonGroup>\n            <Link href=\"/auth/login\">\n              <a>\n                <Button className=\"btn-login\">로그인</Button>\n              </a>\n            </Link>\n            <Link href=\"/auth/register\">\n              <a>\n                <Button className=\"btn-register\" type=\"primary\">\n                  회원가입\n                </Button>\n              </a>\n            </Link>\n          </ButtonGroup>\n        ) : (\n          <ButtonGroup>\n            <Link href=\"/mypage\">\n              <a>\n                <Button className=\"btn-mypage\">마이페이지</Button>\n              </a>\n            </Link>\n            <Button\n              className=\"btn-logout\"\n              type=\"primary\"\n              onClick={onLogout}\n              loading={logoutLoading}\n            >\n              로그아웃\n            </Button>\n          </ButtonGroup>\n        )}\n      </InnerHeader>\n      <MobileMenuWrapper>\n        <MenuItemWrapper\n          key=\"/articles/study\"\n          className=\"menu-study\"\n          currentMenu={currentMenu === \"study\" ? true : false}\n        >\n          <Link href=\"/articles/study\">\n            <a>스터디</a>\n          </Link>\n        </MenuItemWrapper>\n\n        <MenuItemWrapper\n          key=\"/articles/project\"\n          className=\"menu-project\"\n          currentMenu={currentMenu === \"project\" ? true : false}\n        >\n          <Link href=\"/articles/project\">\n            <a>프로젝트</a>\n          </Link>\n        </MenuItemWrapper>\n\n        <MenuItemWrapper\n          key=\"/articles/forum\"\n          className=\"menu-forum\"\n          currentMenu={currentMenu === \"forum\" ? true : false}\n        >\n          <Link href=\"/articles/forum\">\n            <a>포럼</a>\n          </Link>\n        </MenuItemWrapper>\n      </MobileMenuWrapper>\n    </HeaderWrapper>\n  );\n};\n\nexport default withRouter(Header);\n"]},"metadata":{},"sourceType":"module"}