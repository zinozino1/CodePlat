{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/Users/jinho/Project/ProjectFrontend/components/common/Header.jsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport Link from \"next/link\";\nimport { Layout, Menu, Button, Badge } from \"antd\";\nimport { BellOutlined } from \"@ant-design/icons\";\nimport styled, { css } from \"styled-components\";\nimport { withRouter } from \"next/router\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { logoutRequestAction } from \"../../reducers/user\";\nimport firebase from \"../../firebase\";\n/**\n * @author 박진호\n * @version 1.0\n * @summary 헤더 컴포넌트(함수형)\n */\n// style\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar AntHeader = Layout.Header;\nvar HeaderWrapper = styled(AntHeader).withConfig({\n  displayName: \"Header__HeaderWrapper\",\n  componentId: \"sc-1jkvt1g-0\"\n})([\"position:fixed;z-index:10;width:100%;background:#16172b;\"]);\n_c = HeaderWrapper;\nvar InnerHeader = styled.div.withConfig({\n  displayName: \"Header__InnerHeader\",\n  componentId: \"sc-1jkvt1g-1\"\n})([\"width:1300px;margin:0 auto;display:flex;.ant-menu-horizontal{border:none;}@media (max-width:1368px){width:100%;}@media (max-width:1368px){justify-content:space-between;}\"]);\n_c2 = InnerHeader;\nvar LogoWrapper = styled.div.withConfig({\n  displayName: \"Header__LogoWrapper\",\n  componentId: \"sc-1jkvt1g-2\"\n})([\"float:left;cursor:pointer;color:#fff;text-align:center;font-weight:bold;font-size:20px;width:100px;\"]);\n_c3 = LogoWrapper;\nvar MenuWrapper = styled.div.withConfig({\n  displayName: \"Header__MenuWrapper\",\n  componentId: \"sc-1jkvt1g-3\"\n})([\"background:#16172b;font-size:18px;margin:0 auto;height:64px;display:flex;@media (max-width:950px){display:none;}\"]);\n_c4 = MenuWrapper;\nvar MenuItemWrapper = styled.div.withConfig({\n  displayName: \"Header__MenuItemWrapper\",\n  componentId: \"sc-1jkvt1g-4\"\n})([\"padding:0 30px;a{color:#fff;font-weight:500;\", \"}\"], function (props) {\n  if (props.currentMenu) {\n    return css([\"color:#1890ff;\"]);\n  }\n});\n_c5 = MenuItemWrapper;\nvar ButtonGroup = styled.div.withConfig({\n  displayName: \"Header__ButtonGroup\",\n  componentId: \"sc-1jkvt1g-5\"\n})([\".btn-register{margin-left:10px;background:#313355;border:1px solid #313355;&:hover{border:1px solid #16172b;}}.btn-logout{margin-left:10px;background:#313355;border:1px solid #313355;&:hover{border:1px solid #16172b;}}.btn-login{&:hover{color:#313355;border:1px solid #313355;}}.btn-mypage{&:hover{color:#313355;border:1px solid #313355;}}@media (max-width:768px){.btn-mypage,.btn-logout{width:70px;font-size:12px;padding:0;}}\"]);\n_c6 = ButtonGroup;\nvar BadgeWrapper = styled.div.withConfig({\n  displayName: \"Header__BadgeWrapper\",\n  componentId: \"sc-1jkvt1g-6\"\n})([\"margin-right:60px;\"]);\n_c7 = BadgeWrapper;\nvar MobileMenuWrapper = styled.div.withConfig({\n  displayName: \"Header__MobileMenuWrapper\",\n  componentId: \"sc-1jkvt1g-7\"\n})([\"position:fixed;top:64px;left:0;right:0;width:100%;margin:0;background:#16172bcc;z-index:10;display:flex;justify-content:center;\", \" @media (min-width:950px){display:none;}\"], function (props) {\n  if (props.currentMenu) {\n    return css([\"color:#1890ff;\"]);\n  }\n});\n_c8 = MobileMenuWrapper;\n\nvar Header = function Header(_ref) {\n  _s();\n\n  var router = _ref.router;\n  // redux\n  var dispatch = useDispatch();\n\n  var _useSelector = useSelector(function (state) {\n    return state.user;\n  }),\n      me = _useSelector.me,\n      logoutLoading = _useSelector.logoutLoading; // local state\n\n\n  var _useState = useState(null),\n      currentMenu = _useState[0],\n      setCurrentMenu = _useState[1];\n\n  var _useState2 = useState(0),\n      globalCount = _useState2[0],\n      setGlobalCount = _useState2[1];\n\n  var _useState3 = useState(firebase.database().ref(\"chatRooms\")),\n      chatRoomsRef = _useState3[0],\n      setChatRoomsRef = _useState3[1]; // event listener\n\n\n  var onLogout = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var user, firebaseMe;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            user = firebase.auth().currentUser;\n\n            if (!user) {\n              _context.next = 9;\n              break;\n            }\n\n            _context.next = 4;\n            return firebase.auth().signOut().then(function () {});\n\n          case 4:\n            firebaseMe = null;\n            _context.next = 7;\n            return firebase.database().ref(\"users\").child(user.uid).once(\"value\", function (data) {\n              firebaseMe = data.val();\n            });\n\n          case 7:\n            _context.next = 9;\n            return firebase.database().ref(\"users\").child(user.uid).update(_objectSpread(_objectSpread({}, firebaseMe), {}, {\n              isInMypage: false\n            }));\n\n          case 9:\n            dispatch(logoutRequestAction());\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })), []);\n  useEffect( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            setTimeout(function () {\n              var globalCount = 0;\n              var tmpChatRoomInfo = [];\n              me && chatRoomsRef.on(\"child_changed\", function (DataSnapshot) {\n                if (DataSnapshot.val()[me.nickname]) {\n                  globalCount++;\n                  setGlobalCount(globalCount);\n                } else {\n                  tmpChatRoomInfo.forEach(function (v, i) {\n                    if (v.chatRoomId === DataSnapshot.val().id) {\n                      globalCount -= v.count;\n                    }\n                  });\n                  setGlobalCount(globalCount);\n                }\n              });\n              me && chatRoomsRef.on(\"child_added\", function (DataSnapshot) {\n                if (DataSnapshot.val()[me.nickname]) {\n                  globalCount += DataSnapshot.val()[me.nickname].count;\n                  tmpChatRoomInfo.push(DataSnapshot.val()[me.nickname]);\n                  setGlobalCount(globalCount);\n                }\n              });\n              me && chatRoomsRef.on(\"child_removed\", function (DataSnapshot) {// deprecated.\n              });\n            }, 700);\n\n          case 1:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  })), []); // hooks\n\n  useEffect(function () {\n    var route = router.route.split(\"/\");\n    setCurrentMenu(\"\".concat(route[2]));\n  }, [router]);\n  useEffect(function () {\n    return function () {\n      return chatRoomsRef.off();\n    };\n  }, []);\n  return /*#__PURE__*/_jsxDEV(HeaderWrapper, {\n    children: [/*#__PURE__*/_jsxDEV(InnerHeader, {\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        href: \"/\",\n        children: /*#__PURE__*/_jsxDEV(\"a\", {\n          children: /*#__PURE__*/_jsxDEV(LogoWrapper, {\n            children: \"CodePlat\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(MenuWrapper, {\n        children: [/*#__PURE__*/_jsxDEV(MenuItemWrapper, {\n          className: \"menu-study\",\n          currentMenu: currentMenu === \"study\" ? true : false,\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            href: \"/articles/study\",\n            children: /*#__PURE__*/_jsxDEV(\"a\", {\n              children: \"\\uC2A4\\uD130\\uB514\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 13\n          }, _this)\n        }, \"/articles/study\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(MenuItemWrapper, {\n          className: \"menu-project\",\n          currentMenu: currentMenu === \"project\" ? true : false,\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            href: \"/articles/project\",\n            children: /*#__PURE__*/_jsxDEV(\"a\", {\n              children: \"\\uD504\\uB85C\\uC81D\\uD2B8\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 258,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 13\n          }, _this)\n        }, \"/articles/project\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 11\n        }, _this), /*#__PURE__*/_jsxDEV(MenuItemWrapper, {\n          className: \"menu-forum\",\n          currentMenu: currentMenu === \"forum\" ? true : false,\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            href: \"/articles/forum\",\n            children: /*#__PURE__*/_jsxDEV(\"a\", {\n              children: \"\\uD3EC\\uB7FC\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 268,\n              columnNumber: 15\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 267,\n            columnNumber: 13\n          }, _this)\n        }, \"/articles/forum\", false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 11\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 9\n      }, _this), me && /*#__PURE__*/_jsxDEV(BadgeWrapper, {\n        children: /*#__PURE__*/_jsxDEV(Badge, {\n          count: globalCount,\n          offset: [20, 0],\n          children: /*#__PURE__*/_jsxDEV(Link, {\n            href: \"/mypage\",\n            children: /*#__PURE__*/_jsxDEV(\"a\", {\n              className: \"head-example\",\n              children: /*#__PURE__*/_jsxDEV(BellOutlined, {\n                style: {\n                  color: \"#fff\"\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 277,\n                columnNumber: 19\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 17\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 275,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 13\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 11\n      }, _this), !me ? /*#__PURE__*/_jsxDEV(ButtonGroup, {\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          href: \"/auth/login\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn-login\",\n              children: \"\\uB85C\\uADF8\\uC778\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 17\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 13\n        }, _this), /*#__PURE__*/_jsxDEV(Link, {\n          href: \"/auth/register\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn-register\",\n              type: \"primary\",\n              children: \"\\uD68C\\uC6D0\\uAC00\\uC785\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 17\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 13\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 11\n      }, _this) : /*#__PURE__*/_jsxDEV(ButtonGroup, {\n        children: [/*#__PURE__*/_jsxDEV(Link, {\n          href: \"/mypage\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              className: \"btn-mypage\",\n              children: \"\\uB9C8\\uC774\\uD398\\uC774\\uC9C0\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 303,\n              columnNumber: 17\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 15\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 13\n        }, _this), /*#__PURE__*/_jsxDEV(Button, {\n          className: \"btn-logout\",\n          type: \"primary\",\n          onClick: onLogout,\n          loading: logoutLoading,\n          children: \"\\uB85C\\uADF8\\uC544\\uC6C3\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 13\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 11\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 7\n    }, _this), /*#__PURE__*/_jsxDEV(MobileMenuWrapper, {\n      children: [/*#__PURE__*/_jsxDEV(MenuItemWrapper, {\n        className: \"menu-study\",\n        currentMenu: currentMenu === \"study\" ? true : false,\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          href: \"/articles/study\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            children: \"\\uC2A4\\uD130\\uB514\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 11\n        }, _this)\n      }, \"/articles/study\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 318,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(MenuItemWrapper, {\n        className: \"menu-project\",\n        currentMenu: currentMenu === \"project\" ? true : false,\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          href: \"/articles/project\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            children: \"\\uD504\\uB85C\\uC81D\\uD2B8\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 334,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 11\n        }, _this)\n      }, \"/articles/project\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 9\n      }, _this), /*#__PURE__*/_jsxDEV(MenuItemWrapper, {\n        className: \"menu-forum\",\n        currentMenu: currentMenu === \"forum\" ? true : false,\n        children: /*#__PURE__*/_jsxDEV(Link, {\n          href: \"/articles/forum\",\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            children: \"\\uD3EC\\uB7FC\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 13\n          }, _this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 11\n        }, _this)\n      }, \"/articles/forum\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 7\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 233,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(Header, \"CDXckZSnykoqEFrYe9G+jQW9BVk=\", false, function () {\n  return [useDispatch, useSelector];\n});\n\n_c9 = Header;\nexport default _c10 = withRouter(Header);\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10;\n\n$RefreshReg$(_c, \"HeaderWrapper\");\n$RefreshReg$(_c2, \"InnerHeader\");\n$RefreshReg$(_c3, \"LogoWrapper\");\n$RefreshReg$(_c4, \"MenuWrapper\");\n$RefreshReg$(_c5, \"MenuItemWrapper\");\n$RefreshReg$(_c6, \"ButtonGroup\");\n$RefreshReg$(_c7, \"BadgeWrapper\");\n$RefreshReg$(_c8, \"MobileMenuWrapper\");\n$RefreshReg$(_c9, \"Header\");\n$RefreshReg$(_c10, \"%default%\");","map":{"version":3,"sources":["/Users/jinho/Project/ProjectFrontend/components/common/Header.jsx"],"names":["React","useState","useEffect","useCallback","Link","Layout","Menu","Button","Badge","BellOutlined","styled","css","withRouter","useSelector","useDispatch","logoutRequestAction","firebase","AntHeader","Header","HeaderWrapper","InnerHeader","div","LogoWrapper","MenuWrapper","MenuItemWrapper","props","currentMenu","ButtonGroup","BadgeWrapper","MobileMenuWrapper","router","dispatch","state","user","me","logoutLoading","setCurrentMenu","globalCount","setGlobalCount","database","ref","chatRoomsRef","setChatRoomsRef","onLogout","auth","currentUser","signOut","then","firebaseMe","child","uid","once","data","val","update","isInMypage","setTimeout","tmpChatRoomInfo","on","DataSnapshot","nickname","forEach","v","i","chatRoomId","id","count","push","route","split","off","color"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport Link from \"next/link\";\nimport { Layout, Menu, Button, Badge } from \"antd\";\nimport { BellOutlined } from \"@ant-design/icons\";\nimport styled, { css } from \"styled-components\";\nimport { withRouter } from \"next/router\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { logoutRequestAction } from \"../../reducers/user\";\nimport firebase from \"../../firebase\";\n\n/**\n * @author 박진호\n * @version 1.0\n * @summary 헤더 컴포넌트(함수형)\n */\n\n// style\n\nconst AntHeader = Layout.Header;\n\nconst HeaderWrapper = styled(AntHeader)`\n  position: fixed;\n  z-index: 10;\n  width: 100%;\n  background: #16172b;\n`;\n\nconst InnerHeader = styled.div`\n  width: 1300px;\n  margin: 0 auto;\n  display: flex;\n  .ant-menu-horizontal {\n    border: none;\n  }\n  @media (max-width: 1368px) {\n    width: 100%;\n  }\n  @media (max-width: 1368px) {\n    justify-content: space-between;\n  }\n`;\n\nconst LogoWrapper = styled.div`\n  float: left;\n  cursor: pointer;\n  color: #fff;\n  text-align: center;\n  font-weight: bold;\n  font-size: 20px;\n  width: 100px;\n`;\n\nconst MenuWrapper = styled.div`\n  background: #16172b;\n  font-size: 18px;\n  margin: 0 auto;\n  height: 64px;\n  display: flex;\n\n  @media (max-width: 950px) {\n    display: none;\n  }\n`;\n\nconst MenuItemWrapper = styled.div`\n  padding: 0 30px;\n\n  a {\n    color: #fff;\n    font-weight: 500;\n    ${(props) => {\n      if (props.currentMenu) {\n        return css`\n          color: #1890ff;\n        `;\n      }\n    }}\n  }\n`;\n\nconst ButtonGroup = styled.div`\n  .btn-register {\n    margin-left: 10px;\n    background: #313355;\n    border: 1px solid #313355;\n    &:hover {\n      border: 1px solid #16172b;\n    }\n  }\n  .btn-logout {\n    margin-left: 10px;\n    background: #313355;\n    border: 1px solid #313355;\n    &:hover {\n      border: 1px solid #16172b;\n    }\n  }\n  .btn-login {\n    &:hover {\n      color: #313355;\n      border: 1px solid #313355;\n    }\n  }\n  .btn-mypage {\n    &:hover {\n      color: #313355;\n      border: 1px solid #313355;\n    }\n  }\n  @media (max-width: 768px) {\n    .btn-mypage,\n    .btn-logout {\n      width: 70px;\n      font-size: 12px;\n      padding: 0;\n    }\n  }\n`;\n\nconst BadgeWrapper = styled.div`\n  margin-right: 60px;\n`;\n\nconst MobileMenuWrapper = styled.div`\n  position: fixed;\n  top: 64px;\n  left: 0;\n  right: 0;\n  width: 100%;\n  margin: 0;\n  background: #16172bcc;\n  z-index: 10;\n  display: flex;\n  justify-content: center;\n  ${(props) => {\n    if (props.currentMenu) {\n      return css`\n        color: #1890ff;\n      `;\n    }\n  }}\n  @media (min-width: 950px) {\n    display: none;\n  }\n`;\n\nconst Header = ({ router }) => {\n  // redux\n\n  const dispatch = useDispatch();\n  const { me, logoutLoading } = useSelector((state) => state.user);\n\n  // local state\n\n  const [currentMenu, setCurrentMenu] = useState(null);\n  const [globalCount, setGlobalCount] = useState(0);\n  const [chatRoomsRef, setChatRoomsRef] = useState(\n    firebase.database().ref(\"chatRooms\"),\n  );\n\n  // event listener\n\n  const onLogout = useCallback(async () => {\n    let user = firebase.auth().currentUser;\n    if (user) {\n      await firebase\n        .auth()\n        .signOut()\n        .then(() => {});\n      let firebaseMe = null;\n      await firebase\n        .database()\n        .ref(\"users\")\n        .child(user.uid)\n        .once(\"value\", function (data) {\n          firebaseMe = data.val();\n        });\n      await firebase\n        .database()\n        .ref(\"users\")\n        .child(user.uid)\n        .update({ ...firebaseMe, isInMypage: false });\n    }\n\n    dispatch(logoutRequestAction());\n  }, []);\n\n  useEffect(async () => {\n    setTimeout(() => {\n      let globalCount = 0;\n      let tmpChatRoomInfo = [];\n      me &&\n        chatRoomsRef.on(\"child_changed\", (DataSnapshot) => {\n          if (DataSnapshot.val()[me.nickname]) {\n            globalCount++;\n            setGlobalCount(globalCount);\n          } else {\n            tmpChatRoomInfo.forEach((v, i) => {\n              if (v.chatRoomId === DataSnapshot.val().id) {\n                globalCount -= v.count;\n              }\n            });\n            setGlobalCount(globalCount);\n          }\n        });\n      me &&\n        chatRoomsRef.on(\"child_added\", (DataSnapshot) => {\n          if (DataSnapshot.val()[me.nickname]) {\n            globalCount += DataSnapshot.val()[me.nickname].count;\n            tmpChatRoomInfo.push(DataSnapshot.val()[me.nickname]);\n            setGlobalCount(globalCount);\n          }\n        });\n      me &&\n        chatRoomsRef.on(\"child_removed\", (DataSnapshot) => {\n          // deprecated.\n        });\n    }, 700);\n  }, []);\n\n  // hooks\n\n  useEffect(() => {\n    const route = router.route.split(\"/\");\n    setCurrentMenu(`${route[2]}`);\n  }, [router]);\n\n  useEffect(() => {\n    return () => chatRoomsRef.off();\n  }, []);\n\n  return (\n    <HeaderWrapper>\n      <InnerHeader>\n        <Link href=\"/\">\n          <a>\n            <LogoWrapper>CodePlat</LogoWrapper>\n          </a>\n        </Link>\n\n        <MenuWrapper>\n          <MenuItemWrapper\n            key=\"/articles/study\"\n            className=\"menu-study\"\n            currentMenu={currentMenu === \"study\" ? true : false}\n          >\n            <Link href=\"/articles/study\">\n              <a>스터디</a>\n            </Link>\n          </MenuItemWrapper>\n\n          <MenuItemWrapper\n            key=\"/articles/project\"\n            className=\"menu-project\"\n            currentMenu={currentMenu === \"project\" ? true : false}\n          >\n            <Link href=\"/articles/project\">\n              <a>프로젝트</a>\n            </Link>\n          </MenuItemWrapper>\n\n          <MenuItemWrapper\n            key=\"/articles/forum\"\n            className=\"menu-forum\"\n            currentMenu={currentMenu === \"forum\" ? true : false}\n          >\n            <Link href=\"/articles/forum\">\n              <a>포럼</a>\n            </Link>\n          </MenuItemWrapper>\n        </MenuWrapper>\n        {me && (\n          <BadgeWrapper>\n            <Badge count={globalCount} offset={[20, 0]}>\n              <Link href=\"/mypage\">\n                <a className=\"head-example\">\n                  <BellOutlined style={{ color: \"#fff\" }} />\n                </a>\n              </Link>\n            </Badge>\n          </BadgeWrapper>\n        )}\n\n        {!me ? (\n          <ButtonGroup>\n            <Link href=\"/auth/login\">\n              <a>\n                <Button className=\"btn-login\">로그인</Button>\n              </a>\n            </Link>\n            <Link href=\"/auth/register\">\n              <a>\n                <Button className=\"btn-register\" type=\"primary\">\n                  회원가입\n                </Button>\n              </a>\n            </Link>\n          </ButtonGroup>\n        ) : (\n          <ButtonGroup>\n            <Link href=\"/mypage\">\n              <a>\n                <Button className=\"btn-mypage\">마이페이지</Button>\n              </a>\n            </Link>\n            <Button\n              className=\"btn-logout\"\n              type=\"primary\"\n              onClick={onLogout}\n              loading={logoutLoading}\n            >\n              로그아웃\n            </Button>\n          </ButtonGroup>\n        )}\n      </InnerHeader>\n      <MobileMenuWrapper>\n        <MenuItemWrapper\n          key=\"/articles/study\"\n          className=\"menu-study\"\n          currentMenu={currentMenu === \"study\" ? true : false}\n        >\n          <Link href=\"/articles/study\">\n            <a>스터디</a>\n          </Link>\n        </MenuItemWrapper>\n\n        <MenuItemWrapper\n          key=\"/articles/project\"\n          className=\"menu-project\"\n          currentMenu={currentMenu === \"project\" ? true : false}\n        >\n          <Link href=\"/articles/project\">\n            <a>프로젝트</a>\n          </Link>\n        </MenuItemWrapper>\n\n        <MenuItemWrapper\n          key=\"/articles/forum\"\n          className=\"menu-forum\"\n          currentMenu={currentMenu === \"forum\" ? true : false}\n        >\n          <Link href=\"/articles/forum\">\n            <a>포럼</a>\n          </Link>\n        </MenuItemWrapper>\n      </MobileMenuWrapper>\n    </HeaderWrapper>\n  );\n};\n\nexport default withRouter(Header);\n"]},"metadata":{},"sourceType":"module"}