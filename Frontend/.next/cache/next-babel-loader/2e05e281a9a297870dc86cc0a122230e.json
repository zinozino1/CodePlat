{"ast":null,"code":"import React, { useCallback, useEffect, useState } from \"react\";\nimport { Form, Input, Button, Divider, Modal } from \"antd\";\nimport { UserOutlined, LockOutlined } from \"@ant-design/icons\";\nimport Link from \"next/link\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { loginRequestAction } from \"../../reducers/user\";\nimport Router from \"next/router\";\nimport SocialTemplate from \"../common/auth/SocialTemplate\";\nimport axios from \"axios\";\n/**\n * @author 박진호\n * @version 1.0\n * @summary 로그인 종합 컴포넌트\n */\n\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\n\nconst LoginInputForm = () => {\n  // redux\n  const dispatch = useDispatch();\n  const {\n    loginLoading,\n    me,\n    loginError\n  } = useSelector(state => state.user); // local state\n\n  const {\n    0: email,\n    1: setEmail\n  } = useState(\"\");\n  const {\n    0: password,\n    1: setPassword\n  } = useState(\"\");\n  const {\n    0: emailError,\n    1: setEmailError\n  } = useState(false);\n  const {\n    0: passwordError,\n    1: setPasswordError\n  } = useState(false);\n  const {\n    0: isModalVisible,\n    1: setIsModalVisible\n  } = useState(false);\n  const {\n    0: searchEmail,\n    1: setSearchEmail\n  } = useState(\"\"); // event listener\n\n  const onChangeEmail = useCallback(e => {\n    setEmail(e.target.value);\n    setEmailError(false);\n  }, []);\n  const onChangePassword = useCallback(e => {\n    setPassword(e.target.value);\n    setPasswordError(false);\n  }, []);\n  const onLogin = useCallback(() => {\n    if (email == \"\" || password == \"\") {\n      return;\n    }\n\n    dispatch(loginRequestAction({\n      email,\n      password\n    }));\n  }, [email, password]);\n  const showModal = useCallback(e => {\n    setIsModalVisible(true);\n  }, []);\n  const closeModal = useCallback(e => {\n    setIsModalVisible(false);\n  }, []);\n  const onChangeSearchEmail = useCallback(e => {\n    setSearchEmail(e.target.value);\n  }, []);\n  const onSearchPasswordSubmit = useCallback(async () => {\n    await axios.post(`/api/forgotPassword`, {\n      email: searchEmail\n    }).then(res => {\n      if (res.data.message === \"유저 정보가 없습니다\") {\n        alert(\"가입된 이메일이 아닙니다!\");\n        return;\n      } else {\n        alert(\"가입하신 이메일로 링크를 보내드렸습니다.\");\n        setIsModalVisible(false);\n      }\n    }).catch(err => {\n      console.log(err);\n    });\n  }, [searchEmail]);\n  useEffect(() => {\n    if (loginError == \"Incorrect email\") {\n      setEmailError(true);\n      return;\n    } else if (loginError == \"Incorrect password.\") {\n      setPasswordError(true);\n      return;\n    }\n\n    if (me) {\n      Router.push(\"/\");\n    }\n  }, [me, loginError]);\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsxs(Form, {\n      name: \"normal_login\",\n      className: \"login-form\",\n      initialValues: {\n        remember: true\n      },\n      children: [emailError ? /*#__PURE__*/_jsx(Form.Item, {\n        name: \"email\",\n        validateStatus: \"error\",\n        help: \"\\uC874\\uC7AC\\uD558\\uC9C0 \\uC54A\\uB294 \\uC774\\uBA54\\uC77C\\uC785\\uB2C8\\uB2E4.\",\n        rules: [{\n          required: true,\n          message: \"이메일을 입력해주세요.\"\n        }],\n        onChange: onChangeEmail,\n        children: /*#__PURE__*/_jsx(Input, {\n          prefix: /*#__PURE__*/_jsx(UserOutlined, {\n            className: \"site-form-item-icon\"\n          }),\n          placeholder: \"Email\"\n        })\n      }) : /*#__PURE__*/_jsx(Form.Item, {\n        name: \"email\",\n        rules: [{\n          required: true,\n          message: \"이메일을 입력해주세요.\"\n        }],\n        onChange: onChangeEmail,\n        children: /*#__PURE__*/_jsx(Input, {\n          prefix: /*#__PURE__*/_jsx(UserOutlined, {\n            className: \"site-form-item-icon\"\n          }),\n          placeholder: \"Email\"\n        })\n      }), passwordError ? /*#__PURE__*/_jsx(Form.Item, {\n        name: \"password\",\n        validateStatus: \"error\",\n        help: \"\\uBE44\\uBC00\\uBC88\\uD638\\uAC00 \\uB2E4\\uB985\\uB2C8\\uB2E4.\",\n        rules: [{\n          required: true,\n          message: \"비밀번호를 입력해주세요.\"\n        }],\n        onChange: onChangePassword,\n        children: /*#__PURE__*/_jsx(Input, {\n          prefix: /*#__PURE__*/_jsx(LockOutlined, {\n            className: \"site-form-item-icon\"\n          }),\n          type: \"password\",\n          placeholder: \"Password\"\n        })\n      }) : /*#__PURE__*/_jsx(Form.Item, {\n        name: \"password\",\n        rules: [{\n          required: true,\n          message: \"비밀번호를 입력해주세요.\"\n        }],\n        onChange: onChangePassword,\n        children: /*#__PURE__*/_jsx(Input, {\n          prefix: /*#__PURE__*/_jsx(LockOutlined, {\n            className: \"site-form-item-icon\"\n          }),\n          type: \"password\",\n          placeholder: \"Password\"\n        })\n      }), /*#__PURE__*/_jsx(Form.Item, {\n        style: {\n          textAlign: \"center\"\n        },\n        children: /*#__PURE__*/_jsx(Button, {\n          type: \"primary\",\n          htmlType: \"submit\",\n          className: \"login-form-button\",\n          style: {\n            width: \"100%\",\n            background: \"#313355\",\n            color: \"#fff\",\n            border: \"1px solid #313355\"\n          },\n          onClick: onLogin,\n          loading: loginLoading,\n          children: \"\\uB85C\\uADF8\\uC778\"\n        })\n      }), /*#__PURE__*/_jsx(Divider, {\n        style: {\n          fontSize: \"12px\",\n          color: \"#888\"\n        },\n        children: \"\\uC18C\\uC15C \\uB85C\\uADF8\\uC778\"\n      }), /*#__PURE__*/_jsx(SocialTemplate, {}), /*#__PURE__*/_jsxs(Form.Item, {\n        style: {\n          textAlign: \"center\",\n          marginTop: \"10px\",\n          marginBottom: \"0\"\n        },\n        children: [/*#__PURE__*/_jsx(\"span\", {\n          style: {\n            color: \"tomato\",\n            marginRight: \"5px\"\n          },\n          children: \"*\"\n        }), \"\\uACC4\\uC815\\uC774 \\uC5C6\\uC73C\\uC2E0\\uAC00\\uC694?\", /*#__PURE__*/_jsx(Link, {\n          href: \"/auth/register\",\n          children: /*#__PURE__*/_jsx(\"a\", {\n            style: {\n              textDecoration: \"underline\",\n              marginLeft: \"10px\",\n              fontSize: \"12px\",\n              color: \"#999\"\n            },\n            children: \"\\uD68C\\uC6D0\\uAC00\\uC785\"\n          })\n        })]\n      }), /*#__PURE__*/_jsxs(Form.Item, {\n        style: {\n          textAlign: \"center\"\n        },\n        children: [/*#__PURE__*/_jsx(\"span\", {\n          style: {\n            color: \"tomato\",\n            marginRight: \"5px\"\n          },\n          children: \"*\"\n        }), \"\\uBE44\\uBC00\\uBC88\\uD638\\uB97C \\uC78A\\uC73C\\uC168\\uB098\\uC694?\", /*#__PURE__*/_jsx(\"a\", {\n          style: {\n            textDecoration: \"underline\",\n            marginLeft: \"10px\",\n            fontSize: \"12px\",\n            color: \"#999\"\n          },\n          onClick: showModal,\n          children: \"\\uBE44\\uBC00\\uBC88\\uD638 \\uCC3E\\uAE30\"\n        }), /*#__PURE__*/_jsxs(Modal, {\n          title: \"\\uBE44\\uBC00\\uBC88\\uD638 \\uCC3E\\uAE30\",\n          visible: isModalVisible,\n          onOk: closeModal,\n          onCancel: closeModal,\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            children: \"\\uBE44\\uBC00\\uBC88\\uD638\\uB97C \\uC78A\\uC73C\\uC168\\uB098\\uC694? \\uAC00\\uC785\\uD55C \\uC774\\uBA54\\uC77C\\uC744 \\uD1B5\\uD574 \\uBE44\\uBC00\\uBC88\\uD638 \\uC218\\uC815 \\uB9C1\\uD06C\\uAC00 \\uC804\\uC1A1\\uB429\\uB2C8\\uB2E4.\"\n          }), /*#__PURE__*/_jsxs(Form, {\n            children: [/*#__PURE__*/_jsx(Form.Item, {\n              name: \"email\",\n              rules: [{\n                type: \"email\",\n                message: \"이메일 형식으로 입력해주세요.\"\n              }, {\n                required: true,\n                message: \"이메일을 입력해주세요.\"\n              }],\n              children: /*#__PURE__*/_jsx(Input, {\n                placeholder: \"\\uAC00\\uC785\\uB41C \\uC774\\uBA54\\uC77C\\uC744 \\uC785\\uB825\\uD574\\uC8FC\\uC138\\uC694.\",\n                onChange: onChangeSearchEmail\n              })\n            }), /*#__PURE__*/_jsx(Form.Item, {\n              children: /*#__PURE__*/_jsx(\"div\", {\n                style: {\n                  textAlign: \"center\",\n                  margin: \"20px 0\"\n                },\n                children: /*#__PURE__*/_jsx(Button, {\n                  onClick: onSearchPasswordSubmit,\n                  children: \"\\uBE44\\uBC00\\uBC88\\uD638 \\uCC3E\\uAE30\"\n                })\n              })\n            })]\n          })]\n        })]\n      }), /*#__PURE__*/_jsx(Form.Item, {\n        style: {\n          textAlign: \"center\"\n        },\n        children: /*#__PURE__*/_jsx(Link, {\n          href: \"/\",\n          children: /*#__PURE__*/_jsx(\"a\", {\n            style: {\n              color: \"#888\"\n            },\n            children: \"\\uD648\\uC73C\\uB85C\\uAC00\\uAE30\"\n          })\n        })\n      })]\n    })\n  });\n};\n\nexport default LoginInputForm;","map":null,"metadata":{},"sourceType":"module"}