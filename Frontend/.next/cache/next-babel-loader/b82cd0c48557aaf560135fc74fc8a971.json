{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useCallback } from \"react\";\nimport { Card, Avatar, Button, Image, Popover } from \"antd\";\nimport styled from \"styled-components\";\nimport Link from \"next/link\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { logoutRequestAction } from \"../../reducers/user\";\nimport { SERVER_URL } from \"../../lib/constant/constant\";\nimport ProfileModal from \"../modal/ProfileModal\";\nimport { UserOutlined } from \"@ant-design/icons\";\nimport firebase from \"../../firebase\";\n/**\n * @author 박진호\n * @version 1.0\n * @summary 메인 페이지 내 프로필 컴포넌트\n */\n// style\n\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar CardWrapper = styled.div.withConfig({\n  displayName: \"MyProfile__CardWrapper\",\n  componentId: \"sc-17ueru1-0\"\n})([\"padding:20px;\"]);\nvar ButtonsWrapper = styled.div.withConfig({\n  displayName: \"MyProfile__ButtonsWrapper\",\n  componentId: \"sc-17ueru1-1\"\n})([\"margin-top:30px;text-align:center;.mypage{&:hover{color:#313355;border:1px solid #313355;}}.logout{margin-left:10px;background:#313355;color:#fff;&:hover{border:1px solid #313355;}}\"]);\n\nvar MyProfile = function MyProfile(_ref) {\n  var me = _ref.me;\n  // redux\n  var dispatch = useDispatch();\n\n  var _useSelector = useSelector(function (state) {\n    return state.user;\n  }),\n      logoutLoading = _useSelector.logoutLoading; // event listener\n\n\n  var onLogout = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var user, firebaseMe;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            user = firebase.auth().currentUser;\n\n            if (!user) {\n              _context.next = 9;\n              break;\n            }\n\n            _context.next = 4;\n            return firebase.auth().signOut().then(function () {});\n\n          case 4:\n            firebaseMe = null;\n            _context.next = 7;\n            return firebase.database().ref(\"users\").child(user.uid).once(\"value\", function (data) {\n              firebaseMe = data.val();\n            });\n\n          case 7:\n            _context.next = 9;\n            return firebase.database().ref(\"users\").child(user.uid).update(_objectSpread(_objectSpread({}, firebaseMe), {}, {\n              isInMypage: false\n            }));\n\n          case 9:\n            dispatch(logoutRequestAction());\n\n          case 10:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })), []);\n  return /*#__PURE__*/_jsx(CardWrapper, {\n    children: /*#__PURE__*/_jsxs(Card, {\n      children: [/*#__PURE__*/_jsx(Card.Meta, {\n        title: me.nickname,\n        avatar: /*#__PURE__*/_jsx(Popover, {\n          content: /*#__PURE__*/_jsx(\"div\", {\n            onClick: function onClick(e) {\n              e.stopPropagation();\n            },\n            children: /*#__PURE__*/_jsx(ProfileModal, {\n              writer: me\n            })\n          }),\n          children: /*#__PURE__*/_jsx(Avatar, {\n            style: {\n              cursor: \"pointer\"\n            },\n            size: 32,\n            src: me.avatarUrl !== \"\" && me.avatarUrl && /*#__PURE__*/_jsx(Image, {\n              width: 32,\n              height: 32,\n              src: \"\".concat(SERVER_URL, \"/\").concat(me.avatarUrl)\n            }),\n            icon: /*#__PURE__*/_jsx(UserOutlined, {})\n          })\n        })\n      }), /*#__PURE__*/_jsxs(ButtonsWrapper, {\n        children: [/*#__PURE__*/_jsx(Link, {\n          href: \"/mypage\",\n          children: /*#__PURE__*/_jsx(\"a\", {\n            children: /*#__PURE__*/_jsx(Button, {\n              className: \"mypage\",\n              children: \"\\uB9C8\\uC774\\uD398\\uC774\\uC9C0\"\n            })\n          })\n        }), /*#__PURE__*/_jsx(Button, {\n          className: \"logout\",\n          onClick: onLogout,\n          loading: logoutLoading,\n          children: \"\\uB85C\\uADF8\\uC544\\uC6C3\"\n        })]\n      })]\n    })\n  });\n};\n\nexport default MyProfile;","map":null,"metadata":{},"sourceType":"module"}