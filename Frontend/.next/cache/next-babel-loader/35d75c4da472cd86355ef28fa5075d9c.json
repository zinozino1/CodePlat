{"ast":null,"code":"import React, { useState, useCallback, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport EditProfileForm from \"./EditProfileForm\";\nimport SkillFilterForm from \"../common/contents/SkillFilterForm\";\nimport { Button, Card } from \"antd\";\nimport { useSelector } from \"react-redux\";\nimport { SERVER_URL } from \"../../lib/constant/constant\";\nimport shortid from \"shortid\";\nimport { message } from \"antd\";\nimport axios from \"axios\";\nimport FormData from \"form-data\";\n/**\n * @author 박진호\n * @version 1.1\n * @summary 프로필 수정 폼 + 기술 스택 수정 폼 컨테이너 컴포넌트\n */\n\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nvar ProfileReviseFormWrapper = styled.div.withConfig({\n  displayName: \"EditProfile__ProfileReviseFormWrapper\",\n  componentId: \"sc-2rim2x-0\"\n})([\"display:flex;padding:2rem 0;.edit-profile-form{flex:1;padding:20px;}.skill-filter-form{flex:2;padding:20px;}@media (max-width:900px){flex-direction:column;}\"]);\n\nvar EditProfile = function EditProfile() {\n  // redux\n  var _useSelector = useSelector(function (state) {\n    return state.user;\n  }),\n      me = _useSelector.me;\n\n  var _useSelector2 = useSelector(function (state) {\n    return state.skill;\n  }),\n      skill = _useSelector2.skill; // local state\n\n\n  var _useState = useState(me && me.nickname),\n      nickname = _useState[0],\n      setNickname = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      githubId = _useState2[0],\n      setGithubId = _useState2[1];\n\n  var _useState3 = useState(false),\n      gitSecret = _useState3[0],\n      setGitSecret = _useState3[1];\n\n  var _useState4 = useState(null),\n      profileImage = _useState4[0],\n      setProfileImage = _useState4[1];\n\n  var _useState5 = useState(false),\n      loading = _useState5[0],\n      setLoading = _useState5[1]; // event listener\n\n\n  var onChangeNickname = useCallback(function (e) {\n    setNickname(e.target.value);\n  }, []);\n  var onChangeGithubId = useCallback(function (e) {\n    setGithubId(e.target.value);\n  }, []);\n  var onToggleGitSecret = useCallback(function () {\n    setGitSecret(!gitSecret);\n  }, [gitSecret]);\n  var onChangeProfileImage = useCallback(function (e) {\n    setProfileImage(e);\n  }, []);\n  var onDeleteProfileImage = useCallback(function (e) {\n    setProfileImage(null);\n  }, []);\n  var onSubmit = useCallback(function () {\n    setLoading(true);\n    var config = {\n      headers: {\n        Accept: \"application/json\",\n        enctype: \"multipart/form-data\"\n      }\n    };\n    var formData = new FormData();\n    formData.append(\"nickname\", nickname);\n    formData.append(\"githubUrl\", githubId);\n    formData.append(\"techStack\", JSON.stringify(skill));\n    formData.append(\"secretGithub\", gitSecret);\n    formData.append(\"avatar\", profileImage);\n    axios.patch(\"/api/users\", formData, config).then(function (res) {\n      submitDoneMessage();\n    })[\"catch\"](function (err) {\n      console.log(err);\n    });\n    setLoading(false);\n  }, [skill, nickname, githubId, gitSecret, profileImage]); // helper method\n\n  var submitDoneMessage = function submitDoneMessage() {\n    message.success({\n      content: \"저장 완료!\",\n      className: \"custom-class\",\n      style: {\n        marginTop: \"5vh\"\n      }\n    });\n  }; // hooks\n\n\n  useEffect(function () {\n    setProfileImage({\n      uid: shortid.generate(),\n      url: \"\".concat(SERVER_URL, \"/\").concat(me.avatarUrl),\n      thumbUrl: \"\".concat(SERVER_URL, \"/\").concat(me.avatarUrl),\n      status: \"done\"\n    });\n    setNickname(me.nickname);\n    setGithubId(me.githubId);\n  }, [me]);\n  useEffect(function () {\n    if (me) {\n      setGitSecret(me.secretGithub);\n      setGithubId(me.githubUrl);\n    }\n  }, [me]);\n  if (!me) return null;\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsxs(ProfileReviseFormWrapper, {\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: \"edit-profile-form\",\n        children: /*#__PURE__*/_jsx(EditProfileForm, {\n          onChangeProfileImage: onChangeProfileImage,\n          onDeleteProfileImage: onDeleteProfileImage,\n          onChangeNickname: onChangeNickname,\n          onChangeGithubId: onChangeGithubId,\n          onToggleGitSecret: onToggleGitSecret,\n          gitSecret: gitSecret\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: \"skill-filter-form\",\n        children: /*#__PURE__*/_jsxs(Card, {\n          title: \"\\uAD00\\uC2EC \\uAE30\\uC220 \\uC218\\uC815\",\n          bordered: true,\n          children: [\" \", /*#__PURE__*/_jsx(SkillFilterForm, {\n            type: \"mypage\",\n            values: me.techStack,\n            isEdit: true\n          })]\n        })\n      })]\n    }), /*#__PURE__*/_jsx(\"div\", {\n      style: {\n        textAlign: \"center\"\n      },\n      children: /*#__PURE__*/_jsx(Button, {\n        type: \"primary\",\n        onClick: onSubmit,\n        loading: loading,\n        style: {\n          background: \"#313355\",\n          color: \"#fff\",\n          border: \"1px solid #313355\"\n        },\n        children: \"\\uC800\\uC7A5\\uD558\\uAE30\"\n      })\n    })]\n  });\n};\n\nexport default EditProfile;","map":null,"metadata":{},"sourceType":"module"}